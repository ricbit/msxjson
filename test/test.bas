10 CLEAR 500,&H9000
20 BLOAD"JSON.BIN",R
30 M=6:N$="INVALID":F$="ERROR":V=0:GOSUB2000
40 M=8:N$="VALID":F$="JSON":V=-1:GOSUB2000
50 A$="JSON6.TXT":GOSUB3000
60 DATA "",2,"#0",4,"#4",2,"#4#0",4,"#4#1",4,"#4#2",0
70 DATA "#10",4,"#11",0,"END": GOSUB4000
80 A$="JSON7.TXT":GOSUB3000
90 DATA "",2,"#0",5,"#1",6,"#2",7,"#3",0,"END":GOSUB 4000
990 END
1000 OPEN A$ FOR INPUT AS 1
1010 S=LOF(1)
1020 IF S<=0 THEN CLOSE1:RETURN
1030 IF S>200 THEN M=200 ELSE M=S
1040 P$=INPUT$(M,1)
1050 FORX=1TOM:POKEAD+X-1,ASC(MID$(P$,X,1)):NEXT
1060 S=S-M:AD=AD+M
1070 GOTO 1020
2000 FOR I=1 TO M:PRINT"TESTING ";N$;" JSON";I
2010 A$=F$+RIGHT$(STR$(I),1)+".TXT":AD=&H9000:GOSUB 1000
2020 IF USR(&H9000)<>V THEN PRINT "ERROR"
2030 NEXT
2040 RETURN
3000 AD=&H9000:GOSUB1000:A=USR(&H9000):RETURN
4000 READ B$:IF B$="END" THEN RETURN
4010 PRINT "TESTING '";B$;"' ON ";A$
4020 READ B:IF USR1(B$)<>B THEN PRINT "ERROR"
4030 GOTO 4000
